<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Por el poder de los sistemas de ecuaciones de Grayskull - Escape room Matem√°tico</title>

  <!-- Favicon (√∫nico fuera de resources) -->
  <link rel="icon" type="image/png" href="favicon.png">

  <!-- Tipograf√≠as fantasy -->
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@600;800&family=MedievalSharp&display=swap" rel="stylesheet">

  <style>
    body {
      margin: 0;
      font-family: 'Cinzel', serif;
      background: radial-gradient(circle at top, #2b2b5f, #0f0f1f);
      color: #f5f5dc;
    }
    header {
      background: linear-gradient(90deg, #3a3a8a, #1f1f4a);
      padding: 1rem;
      text-align: center;
      font-size: 1.6rem;
      font-weight: 800;
      letter-spacing: 2px;
      text-shadow: 2px 2px 4px #000;
    }
    main { padding: 1rem; max-width: 900px; margin: auto; text-align: center; }
    h2, h3 { font-family: 'MedievalSharp', cursive; letter-spacing: 1px; }
    .hidden { display: none; }
    .card {
      text-align: center;
      background: rgba(0,0,0,0.65);
      padding: 1.2rem;
      border-radius: 14px;
      margin-bottom: 1.2rem;
      box-shadow: 0 0 18px rgba(255,215,0,0.35);
    }
    button {
      background: linear-gradient(#c9a227, #8b6b14);
      color: #000;
      border: none;
      padding: 0.7rem 1rem;
      font-size: 1rem;
      border-radius: 10px;
      cursor: pointer;
      margin: 0.3rem 0.2rem;
      font-family: 'Cinzel', serif;
    }
    button:hover { background: linear-gradient(#ffd700, #c9a227); }
    .timer {
      font-size: 1.1rem;
      font-weight: bold;
      text-align: right;
      margin-bottom: 0.5rem;
      color: #ffd700;
    }
    select, input { padding: 0.4rem; margin: 0.2rem 0; width: 100%; max-width: 220px; }
    img { max-width: 100%; border-radius: 12px; margin: 0.6rem 0; }
    .error { color: #ff9999; font-weight: bold; }
    .feedback { color: #9fd3ff; margin-top: 0.5rem; font-size: 0.9rem; }
    .teacher { background: rgba(255,255,255,0.08); padding: 0.6rem; border-radius: 8px; margin-top: 0.6rem; font-size: 0.85rem; color: #c9e6ff; }

    /* --- V√≠deos tipo click-to-load (como el ejemplo de Harry Potter) --- */
    .video-container {
      position: relative;
      cursor: pointer;
      max-width: 100%;
    }
    .video-container img {
      width: 100%;
      border-radius: 12px;
    }
    .play-button {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 70px;
      height: 70px;
      background: rgba(0,0,0,0.6);
      border-radius: 50%;
      box-shadow: 0 0 15px gold;
    }
    .play-button::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-40%, -50%);
      width: 0;
      height: 0;
      border-left: 22px solid gold;
      border-top: 14px solid transparent;
      border-bottom: 14px solid transparent;
    }

    iframe {
      width: 100%;
      aspect-ratio: 16 / 9;
      border-radius: 12px;
    }

    @media (max-width: 600px) {
      header { font-size: 1.2rem; }
      button { width: 100%; }
    }
  </style>
</head>
<body>
<header>‚öîÔ∏è Por el poder de los sistemas de ecuaciones de Grayskull ‚Äì Escape room Matem√°tico ‚öîÔ∏è</header>
<main>

<section id="start">
  <div class="card">
    <h2>La amenaza de Skeletor</h2>
    <p>Skeletor ha sellado Grayskull con cuatro cerraduras matem√°ticas. He‚ÄëMan necesita tu ayuda.</p>
    <p><strong>Instrucciones:</strong> observa los v√≠deos, lee atentamente el contexto y elige el tiempo disponible. Trabajar√°s en equipo resolviendo sistemas de ecuaciones para avanzar.</p>

    <!-- V√≠deos introductorios (click-to-load) -->
    <div class="video-container" onclick="loadVideo(this,'VIDEO_INTRO_1')">
      <img src="resources/video_intro1.png" alt="V√≠deo introductorio 1">
      <div class="play-button"></div>
    </div>

    <div class="video-container" onclick="loadVideo(this,'VIDEO_INTRO_2')">
      <img src="resources/video_intro2.png" alt="V√≠deo introductorio 2">
      <div class="play-button"></div>
    </div>

    <!-- Imagen introductoria -->
    <img src="resources/imagen_inicio.png" alt="Grayskull y He‚ÄëMan">

    <button onclick="startGame(60)">‚è±Ô∏è 60 minutos</button>
    <button onclick="startGame(90)">‚è±Ô∏è 90 minutos</button>
    <hr>
    <input type="password" id="teacherPass" placeholder="Modo profesor">
    <button onclick="toggleTeacher()">Activar</button>
  </div>
</section>

<section id="p1" class="hidden"><div class="timer"></div><div class="card"><h2>Trap Jaw</h2><p>Analiza el sistema de ecuaciones. Decide si tiene soluci√≥n, infinitas soluciones o ninguna antes de responder.</p><img src="resources/trapjaw.png" alt="Trap Jaw"><p>2x + y - z = 5<br>4x + 2y - 2z = 10<br>2x + y - z = 7</p><select id="p1type" onchange="toggleSolution('p1')"><option value="">Tipo</option><option value="none">Sin soluci√≥n</option><option value="inf">Infinitas</option><option value="one">√önica</option></select><div id="p1sol" class="hidden"></div><button onclick="checkP1()">Comprobar</button><p id="p1error" class="error hidden">Incorrecto</p><div id="p1fb" class="feedback hidden"></div><div class="teacher hidden">Sistema incompatible</div></div></section>

<section id="p2" class="hidden"><div class="timer"></div><div class="card"><h2>Beast Man</h2><p>Observa la relaci√≥n entre las ecuaciones y determina correctamente el tipo de sistema.</p><img src="resources/beastman.png" alt="Beast Man"><p>x + 2y + z = 10<br>2x + 4y + 2z = 20<br>3x + 6y + 3z = 30</p><select id="p2type" onchange="toggleSolution('p2')"><option value="">Tipo</option><option value="none">Sin soluci√≥n</option><option value="inf">Infinitas</option><option value="one">√önica</option></select><div id="p2sol" class="hidden"></div><button onclick="checkP2()">Comprobar</button><p id="p2error" class="error hidden">Incorrecto</p><div id="p2fb" class="feedback hidden"></div><div class="teacher hidden">Sistema compatible indeterminado</div></div></section>

<section id="p3" class="hidden"><div class="timer"></div><div class="card"><h2>Evil‚ÄëLyn</h2><p>Resuelve el sistema paso a paso. Si tiene soluci√≥n √∫nica, introduce los valores correctos de x, y y z.</p><img src="resources/evillyn.png" alt="Evil‚ÄëLyn"><p>2x + y + z = 13<br>x + 2y + z = 14<br>x + y + 2z = 15</p><select id="p3type" onchange="toggleSolution('p3')"><option value="">Tipo</option><option value="none">Sin soluci√≥n</option><option value="inf">Infinitas</option><option value="one">√önica</option></select><div id="p3sol" class="hidden"><input id="p3x" placeholder="x"><input id="p3y" placeholder="y"><input id="p3z" placeholder="z"></div><button onclick="checkP3()">Comprobar</button><p id="p3error" class="error hidden">Incorrecto</p><div id="p3fb" class="feedback hidden"></div><div class="teacher hidden">(3,4,5)</div></div></section>

<section id="p4" class="hidden"><div class="timer"></div><div class="card"><h2>Skeletor</h2><p>Aplica todo lo aprendido sobre sistemas de ecuaciones para derrotar definitivamente a Skeletor.</p><img src="resources/skeletor.png" alt="Skeletor"><p>2x + y + z = 11<br>x + 3y + z = 13<br>x + y + 4z = 19</p><select id="p4type" onchange="toggleSolution('p4')"><option value="">Tipo</option><option value="none">Sin soluci√≥n</option><option value="inf">Infinitas</option><option value="one">√önica</option></select><div id="p4sol" class="hidden"><input id="p4x" placeholder="x"><input id="p4y" placeholder="y"><input id="p4z" placeholder="z"></div><button onclick="checkP4()">Comprobar</button><p id="p4error" class="error hidden">Incorrecto</p><div id="p4fb" class="feedback hidden"></div><div class="teacher hidden">(2,3,4)</div></div></section>

<section id="lock" class="hidden"><div class="timer"></div><div class="card"><h2>üîê Candado final de Grayskull</h2><p><strong>C√≥mo construir las claves:</strong><br>‚Ä¢ Trap Jaw: escribe el tipo de sistema en MAY√öSCULAS.<br>‚Ä¢ Beast Man: escribe el tipo de sistema en MAY√öSCULAS.<br>‚Ä¢ Evil‚ÄëLyn: concatena los valores de x, y y z sin comas.<br>‚Ä¢ Skeletor: concatena los valores de x, y y z sin comas.</p><img src="resources/candado.png" alt="Candado de Grayskull"><input id="c1" placeholder="Clave Trap Jaw"><input id="c2" placeholder="Clave Beast Man"><input id="c3" placeholder="Clave Evil‚ÄëLyn"><input id="c4" placeholder="Clave Skeletor"><button onclick="checkLock()">Abrir</button></div></section>

<section id="success" class="hidden"><div class="card"><h2>üåü ¬°Grayskull ha sido liberado!</h2><p>¬°Enhorabuena! Has superado el escape room aplicando razonamiento matem√°tico y trabajo en equipo.</p><img src="resources/exito.png" alt="Eternia liberada"><div class="video-container" onclick="loadVideo(this,'VIDEO_EXITO')"><img src="resources/video_exito.png" alt="V√≠deo final"><div class="play-button"></div></div><p>Hab√©is demostrado vuestro poder resolviendo sistemas de ecuaciones.</p></div></section>

<section id="fail" class="hidden"><div class="card"><h2>üíÄ Skeletor ha vencido</h2><p>El tiempo se ha agotado. Reflexiona sobre el procedimiento seguido y vuelve a intentarlo.</p><img src="resources/fracaso.png" alt="Skeletor victorioso"><div class="video-container" onclick="loadVideo(this,'VIDEO_FRACASO')"><img src="resources/video_fracaso.png" alt="V√≠deo derrota"><div class="play-button"></div></div><p>El tiempo se ha agotado‚Ä¶ pero siempre se puede aprender del error.</p><button onclick="resetGame()">üîÅ Intentarlo de nuevo</button></div></section>

</main>

<script>
let timeLeft, interval;
// Contadores de intentos por reto
let attempts = { p1: 0, p2: 0, p3: 0, p4: 0 };

function loadVideo(el, id) {
  el.innerHTML = `<iframe src="https://www.youtube.com/embed/${id}?autoplay=1" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>`;
}

function startGame(min) {
  timeLeft = min * 60;
  show('p1');
  interval = setInterval(updateTimer, 1000);
}

function updateTimer() {
  if (timeLeft <= 0) {
    clearInterval(interval);
    show('fail');
    return;
  }
  document.querySelectorAll('.timer').forEach(t => t.textContent = `‚è≥ ${Math.floor(timeLeft/60)}:${String(timeLeft%60).padStart(2,'0')}`);
  timeLeft--;
}

function resetGame() {
  clearInterval(interval);
  document.querySelectorAll('input').forEach(i => i.value = '');
  attempts = { p1: 0, p2: 0, p3: 0, p4: 0 };
  show('start');
}

function show(id) {
  document.querySelectorAll('section').forEach(s => s.classList.add('hidden'));
  document.getElementById(id).classList.remove('hidden');
}

function toggleTeacher() {
  if (teacherPass.value === 'PROFE') document.querySelectorAll('.teacher').forEach(e => e.classList.remove('hidden'));
}

function toggleSolution(pid) {
  const type = document.getElementById(pid + 'type').value;
  const sol = document.getElementById(pid + 'sol');
  if (sol) sol.classList.toggle('hidden', type !== 'one');
}

function checkP1(){
  attempts.p1++;
  const fb = document.getElementById('p1fb');
  p1error.classList.add('hidden'); fb.classList.add('hidden');
  if(p1type.value==='none'){ show('p2'); return; }
  p1error.classList.remove('hidden');
  if(attempts.p1 >= 2){
    fb.classList.remove('hidden');
    fb.textContent = 'Pista: dos ecuaciones son proporcionales, pero la tercera rompe esa proporci√≥n. Revisa los t√©rminos independientes.';
  }
}
  p1error.classList.remove('hidden'); fb.classList.remove('hidden');
  fb.textContent = 'Pista: dos ecuaciones son proporcionales, pero la tercera rompe esa proporci√≥n. Revisa los t√©rminos independientes.';
}
function checkP2(){
  attempts.p2++;
  const fb = document.getElementById('p2fb');
  p2error.classList.add('hidden'); fb.classList.add('hidden');
  if(p2type.value==='inf'){ show('p3'); return; }
  p2error.classList.remove('hidden');
  if(attempts.p2 >= 2){
    fb.classList.remove('hidden');
    fb.textContent = 'Pista: todas las ecuaciones son m√∫ltiplos entre s√≠. Piensa qu√© implica eso sobre el conjunto de soluciones.';
  }
}
  p2error.classList.remove('hidden'); fb.classList.remove('hidden');
  fb.textContent = 'Pista: todas las ecuaciones son m√∫ltiplos entre s√≠. Piensa qu√© implica eso sobre el rango del sistema.';
}
function checkP3(){
  attempts.p3++;
  const fb = document.getElementById('p3fb');
  p3error.classList.add('hidden'); fb.classList.add('hidden');
  if(p3type.value==='one' && +p3x.value===3 && +p3y.value===4 && +p3z.value===5){ show('p4'); return; }
  p3error.classList.remove('hidden');
  if(attempts.p3 >= 2){
    fb.classList.remove('hidden');
    if(p3type.value!=='one') fb.textContent = 'Pista: las ecuaciones no son proporcionales entre s√≠. El sistema puede resolverse.';
    else fb.textContent = 'Pista: comprueba tu soluci√≥n sustituyendo en una de las ecuaciones.';
  }
}
  p3error.classList.remove('hidden'); fb.classList.remove('hidden');
  if(p3type.value!=='one') fb.textContent = 'Pista: las tres ecuaciones no son proporcionales. El sistema se puede resolver por reducci√≥n o Gauss.';
  else fb.textContent = 'Pista: sustituye la soluci√≥n en una de las ecuaciones para comprobarla.';
}
function checkP4(){
  attempts.p4++;
  const fb = document.getElementById('p4fb');
  p4error.classList.add('hidden'); fb.classList.add('hidden');
  if(p4type.value==='one' && +p4x.value===2 && +p4y.value===3 && +p4z.value===4){ show('lock'); return; }
  p4error.classList.remove('hidden');
  if(attempts.p4 >= 2){
    fb.classList.remove('hidden');
    if(p4type.value!=='one') fb.textContent = 'Pista: reflexiona si el sistema admite una √∫nica soluci√≥n.';
    else fb.textContent = 'Pista: revisa los pasos intermedios del c√°lculo.';
  }
}
  p4error.classList.remove('hidden'); fb.classList.remove('hidden');
  if(p4type.value!=='one') fb.textContent = 'Pista: revisa si el determinante del sistema es distinto de cero.';
  else fb.textContent = 'Pista: revisa los c√°lculos intermedios, especialmente al despejar una inc√≥gnita.';
}

function checkLock(){ clearInterval(interval); (c1.value==='INCOMPATIBLE' && c2.value==='INDETERMINADO' && c3.value==='345' && c4.value==='234') ? show('success') : show('fail'); }
</script>
</body>
</html>

